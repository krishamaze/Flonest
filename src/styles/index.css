@import "tailwindcss";
@import "./design-tokens.css";
@import "./design-token-classes.css";

/* PWA Animations */
@keyframes slide-down {
  from {
    transform: translateY(-100%);
    opacity: 0;
  }
  to {
    transform: translateY(0);
    opacity: 1;
  }
}

.animate-slide-down {
  animation: slide-down 0.3s ease-out;
}

@keyframes slide-up {
  from {
    transform: translateY(100%);
    opacity: 0;
  }
  to {
    transform: translateY(0);
    opacity: 1;
  }
}

.animate-slide-up {
  animation: slide-up 0.3s ease-out;
}

@theme {
  /* Brand Colors - Primary */
  --color-primary: var(--color-primary);
  --color-primary-hover: var(--color-primary-hover);
  --color-primary-light: var(--color-primary-light);
  --color-primary-dark: var(--color-primary-dark);
  
  /* Secondary Colors */
  --color-secondary: var(--color-secondary);
  --color-secondary-hover: var(--color-secondary-hover);
  --color-secondary-light: var(--color-secondary-light);
  
  /* Semantic Colors */
  --color-success: var(--color-success);
  --color-success-light: var(--color-success-light);
  --color-success-dark: var(--color-success-dark);
  --color-warning: var(--color-warning);
  --color-warning-light: var(--color-warning-light);
  --color-warning-dark: var(--color-warning-dark);
  --color-error: var(--color-error);
  --color-error-light: var(--color-error-light);
  --color-error-dark: var(--color-error-dark);
  
  /* Neutral Scale */
  --color-neutral-50: var(--color-neutral-50);
  --color-neutral-100: var(--color-neutral-100);
  --color-neutral-200: var(--color-neutral-200);
  --color-neutral-300: var(--color-neutral-300);
  --color-neutral-400: var(--color-neutral-400);
  --color-neutral-500: var(--color-neutral-500);
  --color-neutral-600: var(--color-neutral-600);
  --color-neutral-700: var(--color-neutral-700);
  --color-neutral-800: var(--color-neutral-800);
  --color-neutral-900: var(--color-neutral-900);
  
  /* Semantic Text Colors */
  --color-primary-text: var(--text-primary);
  --color-secondary-text: var(--text-secondary);
  --color-muted-text: var(--text-muted);
  --color-on-primary: var(--text-on-primary);
  --color-on-dark: var(--text-on-dark);
  
  /* Background Colors */
  --color-bg-page: var(--bg-page);
  --color-bg-card: var(--bg-card);
  --color-bg-hover: var(--bg-hover);
  --color-bg-selected: var(--bg-selected);
  
  /* Spacing Scale (8pt Grid) - Map to Tailwind spacing scale */
  --spacing-xs: var(--spacing-xs);
  --spacing-sm: var(--spacing-sm);
  --spacing-md: var(--spacing-md);
  --spacing-lg: var(--spacing-lg);
  --spacing-xl: var(--spacing-xl);
  --spacing-2xl: var(--spacing-2xl);
  --spacing-3xl: var(--spacing-3xl);
  
  /* Font Sizes */
  --font-size-xs: var(--font-size-xs);
  --font-size-sm: var(--font-size-sm);
  --font-size-base: var(--font-size-base);
  --font-size-lg: var(--font-size-lg);
  --font-size-xl: var(--font-size-xl);
  --font-size-2xl: var(--font-size-2xl);
  --font-size-3xl: var(--font-size-3xl);
  --font-size-4xl: var(--font-size-4xl);
  
  /* Font Weights */
  --font-weight-normal: var(--font-weight-normal);
  --font-weight-medium: var(--font-weight-medium);
  --font-weight-semibold: var(--font-weight-semibold);
  --font-weight-bold: var(--font-weight-bold);
  
  /* Border Radius */
  --radius-sm: var(--radius-sm);
  --radius-md: var(--radius-md);
  --radius-lg: var(--radius-lg);
  --radius-xl: var(--radius-xl);
  --radius-full: var(--radius-full);
  
  /* Shadows */
  --shadow-xs: var(--shadow-xs);
  --shadow-sm: var(--shadow-sm);
  --shadow-md: var(--shadow-md);
  --shadow-lg: var(--shadow-lg);
  --shadow-xl: var(--shadow-xl);
  --shadow-primary: var(--shadow-primary);
  
  /* Max Width Scale - Explicitly define to prevent conflict with spacing scale */
  /* Tailwind v4: max-width utilities use their own scale, separate from spacing */
  /* This ensures max-w-lg = 32rem (512px) not 24px (--spacing-lg) */
  --max-width-sm: 24rem;   /* 384px */
  --max-width-md: 28rem;   /* 448px */
  --max-width-lg: 32rem;   /* 512px - Tailwind default */
  --max-width-xl: 36rem;   /* 576px */
  --max-width-2xl: 42rem;  /* 672px */
  --max-width-3xl: 48rem;  /* 768px */
  --max-width-4xl: 56rem;  /* 896px */
  --max-width-5xl: 64rem;  /* 1024px */
}

/* Base Typography */
body {
  font-family: var(--font-primary);
  font-size: var(--font-size-base);
  line-height: var(--line-height-normal);
  color: var(--text-primary);
  background: var(--bg-page);
  /* Prevent scrolling on body - let individual pages handle it */
  overflow-x: hidden;
  /* Disable native pull-to-refresh to prevent height jumps in PWA */
  overscroll-behavior-y: contain;
}

/* Use dynamic viewport height for consistent sizing across devices */
html {
  height: 100%;
  height: 100dvh; /* Dynamic viewport height - accounts for mobile browser bars */
  /* Disable native pull-to-refresh at root level */
  overscroll-behavior-y: contain;
}

#root {
  min-height: 100%;
  min-height: 100dvh;
}

/* Safe Area Insets for Mobile (notch support) */
.safe-top {
  padding-top: env(safe-area-inset-top);
}

.safe-bottom {
  padding-bottom: env(safe-area-inset-bottom);
}

.pb-safe {
  padding-bottom: env(safe-area-inset-bottom);
}

/* Consistent viewport height class */
.viewport-height {
  height: 100vh; /* Fallback for older browsers */
  height: calc(var(--vh, 1vh) * 100); /* JavaScript fallback */
  height: 100dvh; /* Dynamic viewport height - modern browsers */
}

.viewport-height-safe {
  height: calc(100vh - env(safe-area-inset-top) - env(safe-area-inset-bottom)); /* Fallback */
  height: calc(calc(var(--vh, 1vh) * 100) - env(safe-area-inset-top) - env(safe-area-inset-bottom)); /* JavaScript fallback */
  height: calc(100dvh - env(safe-area-inset-top) - env(safe-area-inset-bottom)); /* Dynamic viewport height - modern browsers */
}

/* Touch Target Minimums */
.touch-target {
  min-height: var(--touch-target-min);
  min-width: var(--touch-target-min);
}

/* Utility Classes */
.space-section {
  margin-bottom: var(--spacing-lg);
}

.space-cards {
  gap: var(--spacing-sm);
}

.card-padding {
  padding: var(--spacing-md);
}

/* Animations */
@keyframes spin {
  to { transform: rotate(360deg); }
}

/* Border width utilities */
.border-3 {
  border-width: 3px;
}

/* Android-style smooth transitions */
/* Material Design easing curves */
:root {
  --ease-standard: cubic-bezier(0.4, 0.0, 0.2, 1);
  --ease-decelerate: cubic-bezier(0.0, 0.0, 0.2, 1);
  --ease-accelerate: cubic-bezier(0.4, 0.0, 1, 1);
  --ease-sharp: cubic-bezier(0.4, 0.0, 0.6, 1);
}

/* Page transition animations (Android-style) */
@keyframes fade-in {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}

@keyframes slide-in-right {
  from {
    transform: translateX(20px);
    opacity: 0;
  }
  to {
    transform: translateX(0);
    opacity: 1;
  }
}

@keyframes slide-in-left {
  from {
    transform: translateX(-20px);
    opacity: 0;
  }
  to {
    transform: translateX(0);
    opacity: 1;
  }
}

@keyframes slide-up-smooth {
  from {
    transform: translateY(24px);
    opacity: 0;
  }
  to {
    transform: translateY(0);
    opacity: 1;
  }
}

@keyframes scale-in {
  from {
    transform: scale(0.95);
    opacity: 0;
  }
  to {
    transform: scale(1);
    opacity: 1;
  }
}

/* Smooth page transition */
.page-enter {
  animation: fade-in 200ms var(--ease-decelerate);
}

.page-enter-active {
  animation: fade-in 200ms var(--ease-decelerate);
}

.page-exit {
  animation: fade-in 150ms var(--ease-accelerate) reverse;
}

/* Smooth modal/drawer transitions */
.modal-enter {
  animation: scale-in 200ms var(--ease-decelerate);
}

.drawer-enter {
  animation: slide-up-smooth 300ms var(--ease-decelerate);
}

/* Backdrop fade */
.backdrop-enter {
  animation: fade-in 200ms var(--ease-decelerate);
}

/* Smooth transitions for all interactive elements */
* {
  transition-timing-function: var(--ease-standard);
}

/* Disable transitions on reduced motion preference */
@media (prefers-reduced-motion: reduce) {
  *,
  *::before,
  *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
  }
}

/* Mobile-friendly Toast Styling */
.Toastify__toast-container {
  width: 100%;
  max-width: 90vw;
  padding: 0 var(--spacing-md);
}

.Toastify__toast {
  min-height: 48px;
  padding: var(--spacing-sm) var(--spacing-md);
  border-radius: var(--radius-md);
  margin-bottom: var(--spacing-md);
  font-size: var(--font-size-sm);
  box-shadow: var(--shadow-lg);
}

.Toastify__toast--error {
  background: var(--color-error);
  color: white;
}

.Toastify__toast--success {
  background: var(--color-success);
  color: white;
}

.Toastify__toast--warning {
  background: var(--color-warning);
  color: white;
}

.Toastify__toast--info {
  background: var(--color-secondary);
  color: white;
}

.Toastify__progress-bar {
  background: rgba(255, 255, 255, 0.3);
}

.Toastify__close-button {
  color: white;
  opacity: 0.8;
}

.Toastify__close-button:hover {
  opacity: 1;
}

/* Top-center positioning for toasts */
.Toastify__toast-container--top-center {
  top: 1rem;
  left: 50%;
  transform: translateX(-50%);
  width: 90vw;
  max-width: 500px;
  z-index: 9999; /* Above scanner (9998), below confirmation sheet (10000) */
}

/* Stack toasts vertically */
.Toastify__toast {
  margin-bottom: 0.5rem;
  pointer-events: auto;
  box-shadow: var(--shadow-lg);
}

/* Container doesn't block clicks to underlying content */
.Toastify__toast-container {
  pointer-events: none;
}

/* Toast content is clickable */
.Toastify__toast-container * {
  pointer-events: auto;
}

/* Bottom-center positioning with safe area insets (kept for backwards compatibility) */
.Toastify__toast-container--bottom-center {
  bottom: calc(var(--spacing-md) + env(safe-area-inset-bottom));
  left: 50%;
  transform: translateX(-50%);
}

/* Mobile responsive adjustments */
@media (max-width: 640px) {
  .Toastify__toast-container--top-center {
    top: 0.5rem;
    width: calc(100vw - 1rem);
    max-width: none;
  }
}

/* ========================================
   Scanner UI Styles
   ======================================== */

/* Scanner-specific design tokens */
:root {
  --scanner-primary: var(--color-primary);
  --scanner-shadow: 0 4px 14px rgba(226, 195, 61, 0.3);
  --scanner-gradient: linear-gradient(
    to top,
    rgba(0, 0, 0, 0.8) 0%,
    rgba(0, 0, 0, 0.4) 50%,
    transparent 100%
  );
}

/* Force full-screen container */
#camera-scanner-container {
  position: absolute !important;
  top: 0 !important;
  left: 0 !important;
  width: 100% !important;
  height: 100% !important;
  overflow: hidden !important;
  background: #000 !important;
}

/* Force full-screen video coverage */
#camera-scanner-container video {
  position: absolute !important;
  top: 0 !important;
  left: 0 !important;
  width: 100% !important;
  height: 100% !important;
  object-fit: cover !important;
  object-position: center !important;
  z-index: 1 !important;
}

/* Center scan overlay canvas */
#camera-scanner-container canvas {
  position: absolute !important;
  top: 50% !important;
  left: 50% !important;
  transform: translate(-50%, -50%) !important;
  z-index: 2 !important;
}

/* Center shaded region (scan box overlay) */
#camera-scanner-container #qr-shaded-region {
  position: absolute !important;
  top: 50% !important;
  left: 50% !important;
  transform: translate(-50%, -50%) !important;
  z-index: 2 !important;
  background: rgba(0, 0, 0, 0.3) !important;
  border: none !important;
}

/* Remove default corner styling from Html5Qrcode */
#camera-scanner-container #qr-shaded-region > div {
  display: none !important;
}

/* Custom corner styling (added via DOM manipulation) */
.scanner-corner {
  position: absolute;
  width: 40px;
  height: 40px;
  border: 2px solid var(--scanner-primary);
  box-shadow: 
    0 0 15px var(--scanner-primary),
    var(--scanner-shadow),
    inset 0 0 10px rgba(226, 195, 61, 0.2);
  animation: pulse-glow 2s ease-in-out infinite;
  pointer-events: none;
  z-index: 3;
}

.scanner-corner.corner-top-left {
  top: 0;
  left: 0;
  border-right: none;
  border-bottom: none;
  border-top-left-radius: 8px;
}

.scanner-corner.corner-top-right {
  top: 0;
  right: 0;
  border-left: none;
  border-bottom: none;
  border-top-right-radius: 8px;
}

.scanner-corner.corner-bottom-left {
  bottom: 0;
  left: 0;
  border-right: none;
  border-top: none;
  border-bottom-left-radius: 8px;
}

.scanner-corner.corner-bottom-right {
  bottom: 0;
  right: 0;
  border-left: none;
  border-top: none;
  border-bottom-right-radius: 8px;
}

/* Pulse glow animation for corners */
@keyframes pulse-glow {
  0%, 100% {
    box-shadow: 
      0 0 10px var(--scanner-primary),
      var(--scanner-shadow),
      inset 0 0 10px rgba(226, 195, 61, 0.2);
    opacity: 0.8;
  }
  50% {
    box-shadow: 
      0 0 20px var(--scanner-primary),
      0 0 30px rgba(226, 195, 61, 0.4),
      var(--scanner-shadow),
      inset 0 0 15px rgba(226, 195, 61, 0.3);
    opacity: 1;
  }
}

/* Gradient overlay for bottom guidance */
.scanner-gradient-overlay {
  position: absolute;
  bottom: 0;
  left: 0;
  right: 0;
  padding: var(--spacing-xl) var(--spacing-md) calc(var(--spacing-2xl) + env(safe-area-inset-bottom));
  text-align: center;
  color: white;
  font-size: var(--font-size-sm);
  z-index: 10;
  pointer-events: none;
  background: var(--scanner-gradient);
}

.scanner-gradient-overlay p {
  margin: var(--spacing-xs) 0;
  text-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);
  color: white;
  pointer-events: none;
}

.scanner-gradient-overlay p:first-child {
  font-weight: var(--font-weight-medium);
  font-size: var(--font-size-base);
}

.scanner-gradient-overlay p:last-child {
  font-size: var(--font-size-xs);
  opacity: 0.75;
}

/* Allow buttons inside gradient overlay to be clickable */
.scanner-gradient-overlay button {
  pointer-events: auto;
}

